# ElGamal 加密

In [cryptography](https://en.wikipedia.org/wiki/Cryptography), the **ElGamal encryption system** is an [asymmetric key encryption algorithm](https://en.wikipedia.org/wiki/Asymmetric_key_encryption_algorithm) for [public-key cryptography](https://en.wikipedia.org/wiki/Public-key_cryptography) which is based on the [Diffie–Hellman key exchange](https://en.wikipedia.org/wiki/Diffie–Hellman_key_exchange).

ElGamal encryption can be defined over any [cyclic group](https://en.wikipedia.org/wiki/Cyclic_group) {\displaystyle G}![G](https://wikimedia.org/api/rest_v1/media/math/render/svg/f5f3c8921a3b352de45446a6789b104458c9f90b), like [multiplicative group of integers modulo *n*](https://en.wikipedia.org/wiki/Multiplicative_group_of_integers_modulo_n). Its security depends upon the difficulty of a certain problem in {\displaystyle G}![G](https://wikimedia.org/api/rest_v1/media/math/render/svg/f5f3c8921a3b352de45446a6789b104458c9f90b) related to computing [discrete logarithms](https://en.wikipedia.org/wiki/Discrete_logarithm).

## The algorithm

ElGamal encryption consists of three components: the key generator, the encryption algorithm, and the decryption algorithm.

### Key generation

The first party, Alice, generates a key pair as follows:

- Generate an efficient description of a cyclic group {\displaystyle G\,}![G\,](https://wikimedia.org/api/rest_v1/media/math/render/svg/a1f6c4d01b8be460cde4156d1fde6af720f8ff12) of order {\displaystyle q\,}![q\,](https://wikimedia.org/api/rest_v1/media/math/render/svg/e1a86cf57bb32fa93b5761fe63b7fef8c76c889f) with [generator](https://en.wikipedia.org/wiki/Generating_set_of_a_group) {\displaystyle g}![g](https://wikimedia.org/api/rest_v1/media/math/render/svg/d3556280e66fe2c0d0140df20935a6f057381d77). Let {\displaystyle e}![e](https://wikimedia.org/api/rest_v1/media/math/render/svg/cd253103f0876afc68ebead27a5aa9867d927467) represent the unit element of {\displaystyle G}![G](https://wikimedia.org/api/rest_v1/media/math/render/svg/f5f3c8921a3b352de45446a6789b104458c9f90b).
- Choose an integer {\displaystyle x}![x](https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4) randomly from {\displaystyle \{1,\ldots ,q-1\}}![\{1, \ldots, q-1\}](https://wikimedia.org/api/rest_v1/media/math/render/svg/9c297585d481a11e0b0120f6fff03effee4e021c).
- Compute {\displaystyle h:=g^{x}}![h:=g^{x}](https://wikimedia.org/api/rest_v1/media/math/render/svg/48619a8b44c4bcf7139b7efce3114efc6eb02c53).
- The **[public key](https://en.wikipedia.org/wiki/Public_key)** consists of the values {\displaystyle (G,q,g,h)}![(G,q,g,h)](https://wikimedia.org/api/rest_v1/media/math/render/svg/da0ac9490f7f974c22c1a32d48d8df1458fd7111). Alice publishes this public key and retains {\displaystyle x}![x](https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4) as her **private key**, which must be kept secret.

Alice decrypts a ciphertext {\displaystyle (c_{1},c_{2})}![(c_{1},c_{2})](https://wikimedia.org/api/rest_v1/media/math/render/svg/40f16dff2d0a99e639b57fd5ebf52ef4c558f3a8) with her private key {\displaystyle x}![x](https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4) as follows:

- Compute {\displaystyle s:=c_{1}^{x}}![{\displaystyle s:=c_{1}^{x}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/0ea0e4e10504d0279b7d05bfa1f54473c4a79fd6). Since {\displaystyle c_{1}=g^{y}}![{\displaystyle c_{1}=g^{y}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/ce21a78b341dc17b6435ffdbc038ae5f4fab1e84), {\displaystyle c_{1}^{x}=g^{xy}=h^{y}}![{\displaystyle c_{1}^{x}=g^{xy}=h^{y}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/71a1aade6c3bd8b68c3dc6cfdc1eda5d4c11ce2f), and thus it is the same shared secret that was used by Bob in encryption.
- Compute {\displaystyle s^{-1}}![s^{-1}](https://wikimedia.org/api/rest_v1/media/math/render/svg/68672877fe858638d659f82efca341f116d3fb8b), the inverse of {\displaystyle s}![s](https://wikimedia.org/api/rest_v1/media/math/render/svg/01d131dfd7673938b947072a13a9744fe997e632) in the group {\displaystyle G}![G](https://wikimedia.org/api/rest_v1/media/math/render/svg/f5f3c8921a3b352de45446a6789b104458c9f90b). This can be computed in one of several ways. If {\displaystyle G}![G](https://wikimedia.org/api/rest_v1/media/math/render/svg/f5f3c8921a3b352de45446a6789b104458c9f90b) is a subgroup of a multiplicative group of integers modulo *n*, the [modular multiplicative inverse](https://en.wikipedia.org/wiki/Modular_multiplicative_inverse) can be computed using the [extended Euclidean algorithm](https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm). An alternative is to compute {\displaystyle s^{-1}}![s^{-1}](https://wikimedia.org/api/rest_v1/media/math/render/svg/68672877fe858638d659f82efca341f116d3fb8b) as {\displaystyle c_{1}^{q-x}}![{\displaystyle c_{1}^{q-x}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/ddb1fb22e0fa6fbc151afe0f1f37950f2b8aedc8). This is the inverse of {\displaystyle s}![s](https://wikimedia.org/api/rest_v1/media/math/render/svg/01d131dfd7673938b947072a13a9744fe997e632) because of [Lagrange's theorem](https://en.wikipedia.org/wiki/Lagrange's_theorem_(group_theory)), since {\displaystyle s\cdot c_{1}^{q-x}=g^{xy}\cdot g^{(q-x)y}=(g^{q})^{y}=e^{y}=e}![{\displaystyle s\cdot c_{1}^{q-x}=g^{xy}\cdot g^{(q-x)y}=(g^{q})^{y}=e^{y}=e}](https://wikimedia.org/api/rest_v1/media/math/render/svg/2d4fab0fed9c234e782897425fe4266d35079191).
- Compute {\displaystyle m:=c_{2}\cdot s^{-1}}![{\displaystyle m:=c_{2}\cdot s^{-1}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/848a161fd811bc65dab4e83a8b783ce504e8748e). This calculation produces the original message {\displaystyle m}![m](https://wikimedia.org/api/rest_v1/media/math/render/svg/0a07d98bb302f3856cbabc47b2b9016692e3f7bc), because {\displaystyle c_{2}=m\cdot s}![{\displaystyle c_{2}=m\cdot s}](https://wikimedia.org/api/rest_v1/media/math/render/svg/a550a7d323051652b12dda4430db1642e2458c24); hence {\displaystyle c_{2}\cdot s^{-1}=(m\cdot s)\cdot s^{-1}=m\cdot e=m}![{\displaystyle c_{2}\cdot s^{-1}=(m\cdot s)\cdot s^{-1}=m\cdot e=m}](https://wikimedia.org/api/rest_v1/media/math/render/svg/c5cea02c7fe89810d63932ee13036ee86ac6b4dd).
- Map {\displaystyle m}![m](https://wikimedia.org/api/rest_v1/media/math/render/svg/0a07d98bb302f3856cbabc47b2b9016692e3f7bc) back to the plaintext message {\displaystyle M}![M](https://wikimedia.org/api/rest_v1/media/math/render/svg/f82cade9898ced02fdd08712e5f0c0151758a0dd).
